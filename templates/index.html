<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your App</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <script>
        // Manejo de arrastre y soltado de múltiples archivos
        function dropHandler(event) {
            event.preventDefault();
            const formData = new FormData();
            const files = event.dataTransfer.files;
            for (let i = 0; i < files.length; i++) {
                if (files[i].type === "application/pdf") {
                    formData.append("files[]", files[i]);  // Usamos "files[]" para subir múltiples archivos
                }
            }
            uploadFiles(formData);
        }

        function dragOverHandler(event) {
            event.preventDefault();
        }

        // Manejo de la selección de múltiples archivos
        function fileInputHandler(event) {
            const formData = new FormData();
            const files = event.target.files;
            for (let i = 0; i < files.length; i++) {
                if (files[i].type === "application/pdf") {
                    formData.append("files[]", files[i]);  // Usamos "files[]" para subir múltiples archivos
                }
            }
            uploadFiles(formData);
        }

        function uploadFiles(formData) {
            fetch('/upload', {
                method: 'POST',
                body: formData
            }).then(response => {
                if (response.ok) {
                    window.location.reload();
                }
            });
        }

        // Función para eliminar un archivo
        function deleteFile(filename) {
            fetch('/delete', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ filename: filename })
            }).then(response => {
                if (response.ok) {
                    window.location.reload();
                }
            });
        }
    </script>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <h1>Rag Ask to your Documents</h1>
    </div>

    <!-- Contenedor principal de la aplicación -->
    <div class="container">
        <div class="left-half">
            <div class="drop-zone" onclick="document.getElementById('fileInput').click()" ondrop="dropHandler(event);" ondragover="dragOverHandler(event);">
                Arrastra tus archivos aquí o haz clic para seleccionar
            </div>
            <input type="file" id="fileInput" accept=".pdf" style="display: none;" onchange="fileInputHandler(event)" multiple>  <!-- Acepta múltiples archivos -->
            <div class="file-grid">
                <ul>
                    {% for file in files %}
                    <li>
                        {{ file }}
                        <span class="delete-icon" onclick="deleteFile('{{ file }}')">&times;</span>
                    </li>
                    {% endfor %}
                </ul>
            </div>
            <button class="load-button">LOAD</button>
        </div>
        <div class="right-half">
            <div class="rol">
                <label for="rol-input">Rol:</label>
                <input type="text" id="rol-input" class="text-input" />
            </div>
            <div class="embedding_model">
                <label for="embedding-select">Embedding:</label>
                <select id="embedding-select" class="select-input">
                    <option value="model-1">Modelo-1</option>
                    <option value="model-2">Modelo-2</option>
                    <option value="model-3">Modelo-3</option>
                </select>
            </div>
            <div class="pregunta">
                <label for="pregunta-input">Pregunta:</label>
                <textarea id="pregunta-input" class="text-input"></textarea>
            </div>
            <button class="do-it-button">DO IT!</button>
            <div class="output-grid">
                <!-- Aquí se escribirá el output del software -->
            </div>
        </div>
    </div>
</body>
</html>
